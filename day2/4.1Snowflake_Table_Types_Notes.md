# Snowflake Table Types

![alt text](image-3.png)
## Permanent Table
- Default table type in Snowflake; persists until dropped.
- Best for highest level of data protection and recovery.
- Time Travel: Up to 90 days (Enterprise Edition).
- Fail-safe: 7-day grace period after Time Travel ends.
- Use for production and critical datasets.
```sql
CREATE OR REPLACE TABLE orders (
    order_id INT,
    order_date DATE
);
```

## Temporary Table
- Exists only for the duration of a session; dropped automatically after session ends.
- Time Travel: Maximum 1 day (or 0).
- No Fail-safe.
- Use for intermediate ETL steps or session-specific calculations.
```sql
CREATE OR REPLACE TEMPORARY TABLE temp_orders (
    order_id INT,
    total_amount NUMBER(10,2)
);
```

## Transient Table
- Persists until dropped, not tied to a session.
- Similar to permanent tables but with reduced retention and no Fail-safe.
- Time Travel: Maximum 1 day.
- Use for staging or semi-permanent non-critical data.
```sql
CREATE OR REPLACE TRANSIENT TABLE staging_orders (
    order_id INT,
    order_status STRING
);
```

## Comparison Table
- Permanent: Highest persistence, up to 90-day Time Travel, has Fail-safe.
- Transient: Persists until dropped, 1-day Time Travel, no Fail-safe.
- Temporary: Session only, 1-day Time Travel, no Fail-safe.

## Identify Table Types
- Use SHOW TABLES IN SCHEMA to view table kind (TABLE, TRANSIENT, TEMPORARY).
```sql
SHOW TABLES IN SCHEMA MY_DB.MY_SCHEMA;
```

## Change Data Retention
- Permanent: Up to 90 days.
- Transient/Temporary: Max 1 day.
```sql
ALTER TABLE orders
SET DATA_RETENTION_TIME_IN_DAYS = 30;
```

## Creating All Three Table Types
- Examples for permanent, transient, and temporary tables.
```sql
CREATE OR REPLACE TABLE sales_data (
    sale_id INT,
    amount NUMBER(10,2)
);

CREATE OR REPLACE TRANSIENT TABLE sales_stage (
    sale_id INT,
    region STRING
);

CREATE OR REPLACE TEMPORARY TABLE sales_temp (
    sale_id INT,
    discount NUMBER(5,2)
);
```

```sql

-- Set context
USE ROLE ACCOUNTADMIN;
USE WAREHOUSE COMPUTE_WH;
USE SCHEMA MYDB.MYSCHEMA;

-- 1) Permanent table (default type)
CREATE OR REPLACE TABLE PERMANENT_TABLE (
  ID   INT,
  NAME STRING
);

-- Permanent tables can have up to 90 days (Enterprise)
ALTER TABLE PERMANENT_TABLE
  SET DATA_RETENTION_TIME_IN_DAYS = 3;

-- 2) Transient table
CREATE OR REPLACE TRANSIENT TABLE TRANSIENT_TABLE (
  ID   INT,
  NAME STRING
);

-- Max retention for TRANSIENT is 1 day (2 would fail)
ALTER TABLE TRANSIENT_TABLE
  SET DATA_RETENTION_TIME_IN_DAYS = 1;

-- 3) Temporary table (session-scoped)
CREATE OR REPLACE TEMPORARY TABLE TEMPORARY_TABLE (
  ID   INT,
  NAME STRING
);

-- Verify types and retention
SHOW TABLES IN SCHEMA MYDB.MYSCHEMA;
```

![alt text](image-4.png)



```SQL
ALTER TABLE SALES_DATA SET DATA_RETENTION_TIME_IN_DAYS=7;`
```

```SQL
INSERT INTO SALES_DATA VALUES (2,'8999.00');
```


If you **drop a table today (at 5 PM)** in Community Edition:
```SQL
DROP TABLE SALES_DATA;
```


You can **restore it within the retention period** using:
```SQL 
-- RESTORING DROPPED TABLE`
UNDROP TABLE SALES_DATA;
SELECT * FROM SALES_DATA;
```
### ⚠️ Note:
In the **Snowflake Community Edition**, you can restore dropped tables **only within 24 hours.**
After that, the table is **permanently deleted**.

